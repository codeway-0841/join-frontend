(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{176:function(e,a,t){e.exports=t.p+"static/media/wave.2b8196a5.svg"},177:function(e,a,t){e.exports=t.p+"static/media/play.65f03140.svg"},178:function(e,a,t){e.exports=t.p+"static/media/pause.a61933e8.svg"},183:function(e,a,t){e.exports=t.p+"static/media/readed.c1f419d6.svg"},184:function(e,a,t){e.exports=t.p+"static/media/noreaded.3c841bf6.svg"},198:function(e,a,t){e.exports=t(428)},208:function(e,a,t){},254:function(e,a,t){},256:function(e,a,t){},257:function(e,a,t){},364:function(e,a,t){},365:function(e,a,t){},366:function(e,a,t){},371:function(e,a,t){},406:function(e,a,t){},425:function(e,a,t){},426:function(e,a,t){},428:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(11),c=t.n(l),s=t(32),i=t(53),o=t(168),m=t(169),u=t(195),d=t(170),g=t(196),E=t(41),p=t(84),f=t(430),_=t(431),v=t(18),h=t(88),b=t(3),N=t.n(b),S=(t(208),function(e){return r.a.createElement(h.a,Object.assign({},e,{className:N()("button",e.className,{"button--large":"large"===e.size})}))}),y=(t(254),function(e){var a=e.children,t=e.className;return r.a.createElement("div",{className:N()("block",t)},a)}),O=t(17),I=t(119),j=function(e,a,t){return a[e]?t[e]?"error":"success":""},w=t(83),L=t.n(w),k=t(176),D=t.n(k),M=t(177),x=t.n(M),T=t(178),A=t.n(T),C=(t(256),function(e){var a=e.audioSrc,t=Object(n.useRef)(null),l=Object(n.useState)(!1),c=Object(O.a)(l,2),s=c[0],i=c[1],o=Object(n.useState)(0),m=Object(O.a)(o,2),u=m[0],d=m[1],g=Object(n.useState)(0),E=Object(O.a)(g,2),p=E[0],f=E[1];return Object(n.useEffect)(function(){t.current.volume="0.01",t.current.addEventListener("playing",function(){i(!0)},!1),t.current.addEventListener("ended",function(){i(!1),d(0),f(0)},!1),t.current.addEventListener("pause",function(){i(!1)},!1),t.current.addEventListener("timeupdate",function(){var e=t.current&&t.current.duration||0;f(t.current.currentTime),d(t.current.currentTime/e*100)})},[]),r.a.createElement("div",{className:"message__audio"},r.a.createElement("audio",{ref:t,src:a,preload:"auto"}),r.a.createElement("div",{className:"message__audio-progress",style:{width:u+"%"}}),r.a.createElement("div",{className:"message__audio-info"},r.a.createElement("div",{className:"message__audio-btn"},r.a.createElement("button",{onClick:function(){s?t.current.pause():t.current.play()}},s?r.a.createElement("img",{src:A.a,alt:"Pause svg"}):r.a.createElement("img",{src:x.a,alt:"Play svg"}))),r.a.createElement("div",{className:"message__audio-wave"},r.a.createElement("img",{src:D.a,alt:"Wave svg"})),r.a.createElement("span",{className:"message__audio-duration"},function(e){var a=Math.floor(e/60),t=(e%60).toFixed();return"".concat(a<10?"0":"").concat(a,":").concat(t<10?"0":"").concat(t)}(p))))}),R=function(e){e.avatar;var a=e.user,t=e.text,n=e.date,l=e.audio,c=e.isMe,s=e.isReaded,i=e.attachments,o=e.isTyping;return r.a.createElement("div",{className:N()("message",{"message--isme":c,"message--is-typing":o,"message--is-audio":l,"message--image":i&&1===i.length})},r.a.createElement("div",{className:"message__content"},r.a.createElement(ae,{isMe:c,isReaded:s}),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(le,{user:a})),r.a.createElement("div",{className:"message__info"},(l||t||o)&&r.a.createElement("div",{className:"message__bubble"},t&&r.a.createElement("p",{className:"message__text"},t),o&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),l&&r.a.createElement(C,{audioSrc:l})),i&&r.a.createElement("div",{className:"message__attachments"},i.map(function(e,a){return r.a.createElement("div",{key:a,className:"message__attachments-item"},r.a.createElement("img",{src:e.url,alt:e.filename}))})),n&&r.a.createElement("span",{className:"message__date"},r.a.createElement(W,{date:n})))))};R.defaultProps={user:{}};var z=R,P=t(429),G=t(56),F=(t(257),function(e){var a=e.blockRef,t=e.isLoading,n=e.items;return r.a.createElement("div",{ref:a,className:N()("messages",{"messages--loading":t})},t?r.a.createElement(P.a,{size:"large",tip:"Loading messages ..."}):n&&!t?n.length>0?n.map(function(e){return r.a.createElement(z,Object.assign({key:e._id},e))}):r.a.createElement(G.a,{description:"The dialog is empty"}):r.a.createElement(G.a,{description:"Open dialogue"}))}),B=t(123),V=t.n(B),U=t(180),J=t.n(U),Y=function(e){var a=e._id,t=e.user,n=e.undread,l=e.created_at,c=e.text,s=e.isMe,i=e.currentDialogId,o=e.onSelect;return r.a.createElement("div",{className:N()("dialogs__item",{"dialogs__item--online":t.isOnline,"dialogs__item--selected":i===a}),onClick:o.bind(void 0,a)},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(le,{user:t})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",null,t.fullname),r.a.createElement("span",null,function(e){return J()(e)?V()(e,"HH:mm"):V()(e,"DD.MM.YYYY")}(l))),r.a.createElement("div",{className:"dialogs__item-info-bottom"},r.a.createElement("p",null,c),s&&r.a.createElement(ae,{isMe:!0,isReaded:!1}),n>0&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},n>9?"+9":n))))},Z=t(181),H=t.n(Z),X=t(182),K=t.n(X),W=function(e){var a=e.date;return r.a.createElement(n.Fragment,null,H()(a,{addSuffix:!0,locale:K.a}))},$=t(183),q=t.n($),Q=t(184),ee=t.n(Q),ae=function(e){var a=e.isMe,t=e.isReaded;return a&&(t?r.a.createElement("img",{className:"message__icon-readed",src:q.a,alt:"Readed icon"}):r.a.createElement("img",{className:"message__icon-readed message__icon-readed--no",src:ee.a,alt:"No readed icon"}))||null},te=t(185),ne=t.n(te),re=(t(364),function(e){var a=e.items,t=e.userId,n=e.onSearch,l=e.inputValue,c=e.currentDialogId,s=e.onSelectDialog;return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(_.a.Search,{placeholder:"Search among contacts",onChange:function(e){return n(e.target.value)},value:l})),a.length?ne()(a,["created_at"],["desc"]).map(function(e){return r.a.createElement(Y,Object.assign({onSelect:s,key:e._id,isMe:e.user._id===t,currentDialogId:c},e))}):r.a.createElement(G.a,{image:G.a.PRESENTED_IMAGE_SIMPLE,description:"Nothing found"}))}),le=(t(365),function(e){var a=e.user;if(a.avatar)return r.a.createElement("img",{className:"avatar",src:a.avatar,alt:"Avatar ".concat(a.fullname)});var t=function(e){var a=e.substr(0,3).split("").map(function(e){return(a=e.charCodeAt(0))>255?255:a<0?0:a>255?255:a<0?0:a;var a}),t=Object(O.a)(a,3),n=t[0],r=t[1],l=t[2];return{color:L()({r:n,g:r,b:l}).lighten(10).saturate(10).toHexString(),colorLighten:L()({r:n,g:r,b:l}).lighten(30).saturate(30).toHexString()}}(a._id),n=t.color,l=t.colorLighten,c=a.fullname[0].toUpperCase();return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(l," 96.52%)")},className:"avatar avatar--symbol"},c)}),ce=(t(366),function(e){var a=e.online;return r.a.createElement("span",{className:N()("status",{"status--online":a})},a?"\u043e\u043d\u043b\u0430\u0439\u043d":"\u043e\u0444\u043b\u0430\u0439\u043d")}),se=t(187),ie=(t(371),function(e){var a=Object(n.useState)(""),t=Object(O.a)(a,2),l=t[0],c=t[1],s=Object(n.useState)(!1),i=Object(O.a)(s,2),o=i[0],m=i[1];return r.a.createElement("div",{className:"chat-input"},r.a.createElement("div",{className:"chat-input__smile-btn"},o&&r.a.createElement("div",{className:"chat-input__emoji-picker"},r.a.createElement(I.a,{set:"apple"})),r.a.createElement(h.a,{onClick:function(){m(!o)},type:"link",shape:"circle",icon:"smile"})),r.a.createElement(_.a,{onChange:function(e){return c(e.target.value)},size:"large",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u2026"}),r.a.createElement("div",{className:"chat-input__actions"},r.a.createElement(se.UploadField,{onFiles:function(e){return console.log(e)},containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(h.a,{type:"link",shape:"circle",icon:"camera"})),l?r.a.createElement(h.a,{type:"link",shape:"circle",icon:"check-circle"}):r.a.createElement(h.a,{type:"link",shape:"circle",icon:"audio"})))}),oe=function(e){var a=e.values,t=e.touched,n=e.errors,l=e.handleChange,c=e.handleBlur,i=e.handleSubmit,o=e.isValid,m=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"Login to your account"),r.a.createElement("p",null,"Please login to your account")),r.a.createElement(y,null,r.a.createElement(f.a,{onSubmit:i,className:"login-form"},r.a.createElement(f.a.Item,{validateStatus:j("email",t,n),help:t.email?n.email:"",hasFeedback:!0},r.a.createElement(_.a,{id:"email",prefix:r.a.createElement(v.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:"E-Mail",value:a.email,onChange:l,onBlur:c})),r.a.createElement(f.a.Item,{validateStatus:j("password",t,n),help:t.password?n.password:"",hasFeedback:!0},r.a.createElement(_.a,{id:"password",prefix:r.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),size:"large",type:"password",placeholder:"Password",value:a.password,onChange:l,onBlur:c})),r.a.createElement(f.a.Item,null,m&&!o&&r.a.createElement("span",null,"Error!"),r.a.createElement(S,{onClick:i,type:"primary",size:"large"},"Log in")),r.a.createElement(s.b,{className:"auth__register-link",to:"/register"},"Register now"))))},me=function(e){var a=e.isAuth,t=e.values,n=e.errors,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(n.email="Invalid E-Mail"):n.email="Enter E-Mail"},password:function(e){e?/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/.test(e)||(n.password=a?"Invalid password":"Password too light"):n.password="Enter password"}};Object.keys(t).forEach(function(e){return r[e]&&r[e](t[e])})},ue=Object(p.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var a={};return me({isAuth:!0,values:e,errors:a}),a},handleSubmit:function(e,a){var t=a.setSubmitting;setTimeout(function(){alert(JSON.stringify(e,null,2)),t(!1)},1e3)},displayName:"LoginForm"})(oe),de=function(e){var a=e.values,t=e.touched,n=e.errors,l=e.handleChange,c=e.handleBlur,i=e.handleSubmit,o=e.isValid,m=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"Registration"),r.a.createElement("p",null,"To enter the chat, you need to register")),r.a.createElement(y,null,r.a.createElement(f.a,{onSubmit:i,className:"login-form"},r.a.createElement(f.a.Item,{validateStatus:j("email",t,n),help:t.email?n.email:"",hasFeedback:!0},r.a.createElement(_.a,{id:"email",prefix:r.a.createElement(v.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:"E-Mail",value:a.email,onChange:l,onBlur:c})),r.a.createElement(f.a.Item,null,r.a.createElement(_.a,{prefix:r.a.createElement(v.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:"Your name"})),r.a.createElement(f.a.Item,{validateStatus:j("password",t,n),help:t.password?n.password:"",hasFeedback:!0},r.a.createElement(_.a,{id:"password",prefix:r.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),size:"large",type:"password",placeholder:"Password",value:a.password,onChange:l,onBlur:c})),r.a.createElement(f.a.Item,{validateStatus:j("password",t,n)},r.a.createElement(_.a,{prefix:r.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),size:"large",type:"password2",placeholder:"Confirm password"})),r.a.createElement(f.a.Item,null,m&&!o&&r.a.createElement("span",null,"Error!"),r.a.createElement(S,{onClick:i,type:"primary",size:"large"},"Registration")),r.a.createElement(s.b,{className:"auth__register-link",to:"/login"},"Log in"))))},ge=Object(p.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",fullname:"",password:"",password2:""}},validate:function(e){var a={};return me({isAuth:!1,values:e,errors:a}),a},handleSubmit:function(e,a){var t=a.setSubmitting;setTimeout(function(){alert(JSON.stringify(e,null,2)),t(!1)},1e3)},displayName:"RegisterForm"})(de),Ee=(t(406),function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__content"},r.a.createElement(E.a,{exact:!0,path:["/","/login"],component:ue}),r.a.createElement(E.a,{exact:!0,path:"/register",component:ge})))}),pe=t(126),fe=t.n(pe);fe.a.defaults.baseURL="http://localhost:9999";var _e=fe.a,ve=function(){return _e.get("/dialogs")},he=function(e){return _e.get("/messages?dialog="+e)},be={setDialogs:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},setCurrentDialogId:function(e){return{type:"DIALOGS:SET_CURRENT_DIALOG_ID",payload:e}},fetchDialogs:function(){return function(e){ve().then(function(a){var t=a.data;e(be.setDialogs(t))})}}},Ne=be,Se={setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}},fetchMessages:function(e){return function(a){a(Se.setIsLoading(!0)),he(e).then(function(e){var t=e.data;a(Se.setMessages(t))}).catch(function(){a(Se.setIsLoading(!1))})}}},ye=Se,Oe=Object(i.b)(function(e){return e.dialogs},Ne)(function(e){var a=e.fetchDialogs,t=e.currentDialogId,l=e.setCurrentDialogId,c=e.items,s=e.userId,i=Object(n.useState)(""),o=Object(O.a)(i,2),m=o[0],u=o[1],d=Object(n.useState)(Array.from(c)),g=Object(O.a)(d,2),E=g[0],p=g[1];return Object(n.useEffect)(function(){c.length?p(c):a()},[c]),r.a.createElement(re,{userId:s,items:E,onSearch:function(e){p(c.filter(function(a){return a.user.fullname.toLowerCase().indexOf(e.toLowerCase())>=0})),u(e)},inputValue:m,onSelectDialog:l,currentDialogId:t})}),Ie=Object(i.b)(function(e){var a=e.dialogs,t=e.messages;return{currentDialogId:a.currentDialogId,items:t.items,isLoading:t.isLoading}},ye)(function(e){var a=e.currentDialogId,t=e.fetchMessages,l=e.items,c=e.isLoading,s=Object(n.useRef)(null);return Object(n.useEffect)(function(){a&&t(a)},[a]),Object(n.useEffect)(function(){s.current.scrollTo(0,999999)},[l]),r.a.createElement(F,{blockRef:s,items:l,isLoading:c})}),je=(t(425),function(){return r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",null,r.a.createElement(v.a,{type:"team"}),r.a.createElement("span",{className:"brand"},"Join")),r.a.createElement(h.a,{type:"link",shape:"circle",icon:"form"})),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(Oe,{userId:0}))),r.a.createElement("div",{className:"chat__dialog"},r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",null),r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement("img",{src:"https://scontent.ftas1-1.fna.fbcdn.net/v/t1.0-1/s200x200/151323779_939904703483162_4260875257250539935_n.jpg?_nc_cat=106&ccb=3&_nc_sid=7206a8&_nc_ohc=z__8b0znKZgAX9xxsnL&_nc_ht=scontent.ftas1-1.fna&tp=7&oh=269e453662c8419e0418fe026f20f5de&oe=6061B111",alt:""})),r.a.createElement("div",null,r.a.createElement("b",{className:"chat__dialog-header-username"},"Ruslan Ablyamitov"),r.a.createElement("div",{className:"chat__dialog-header-status"},r.a.createElement(ce,{online:!0})))),r.a.createElement("span",null,r.a.createElement(h.a,{type:"link",shape:"circle",icon:"phone"}),r.a.createElement(h.a,{type:"link",shape:"circle",icon:"camera"}),r.a.createElement(h.a,{type:"link",shape:"circle",icon:"ellipsis"}))),r.a.createElement("div",{className:"chat__dialog-messages"},r.a.createElement(Ie,null)),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement(ie,null)))))}),we=function(e){function a(){return Object(o.a)(this,a),Object(u.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(g.a)(a,e),Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper"},r.a.createElement(E.a,{exact:!0,path:["/","/login","/register"],component:Ee}),r.a.createElement(E.a,{exact:!0,path:"/im",component:je}))}}]),a}(n.Component),Le=t(33),ke=t(193),De=t(55),Me={items:[],currentDialogId:null,isLoading:!1},xe={items:null,isLoading:!1},Te=Object(Le.c)({dialogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"DIALOGS:SET_ITEMS":return Object(De.a)({},e,{items:n});case"DIALOGS:SET_CURRENT_DIALOG_ID":return Object(De.a)({},e,{currentDialogId:n});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"MESSAGES:SET_ITEMS":return Object(De.a)({},e,{items:n,isLoading:!1});case"MESSAGES:SET_IS_LOADING":return Object(De.a)({},e,{isLoading:n});default:return e}}}),Ae=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Le.d,Ce=[ke.a],Re=Object(Le.e)(Te,Ae(Le.a.apply(void 0,Ce)));t(426),t(427);c.a.render(r.a.createElement(i.a,{store:Re},r.a.createElement(s.a,null,r.a.createElement(we,null))),document.getElementById("root"))}},[[198,1,2]]]);
//# sourceMappingURL=main.09d6a86e.chunk.js.map